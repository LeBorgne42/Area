{% extends 'base.html.twig' %}

{% trans_default_domain 'front_fleet' %}

{% block title %}{{ 'title'|trans }}{% endblock %}

{% block body %}
    {% for message in app.flashes('fail') %}
        <div class="flash-notice mt-5 alerte-flash-error text-center">
            {{ message }}
        </div>
    {% endfor %}
    <div class="front-block">
        {% if app.user.getTutorial() == 10 or app.user.getTutorial() == 11 or app.user.getTutorial() == 21 %}
            <table class="table table-striped borderOverview tutorial">
                <tbody>
                <tr>
                    <th class="tab-cells-name p-3 tutorial">
                        <div class="row">
                            <div class="col-12 py-1">
                                {% if app.user.getTutorial() == 10  %}{{ 'fleet.tutorial'|trans|raw }}{% elseif app.user.getTutorial() == 11  %}{{ 'fleet.tutorialBis'|trans|raw }}{% elseif app.user.getTutorial() == 21  %}{{ 'fleet.tutorialTer'|trans|raw }}{% endif %}
                            </div>
                        </div>
                    </th>
                </tr>
                </tbody>
            </table>
        {% endif %}
        <div class="display-allFleet">
            <div class="block-title"><h2>{{ 'fleet.onThisPlanet'|trans({'%planet%': usePlanet.getName()}) }} <span class="glyphicon glyphicon-question-sign text-orange text-middle" data-toggle="tooltip" data-placement="top" title="{{ 'tooltip.fleetOnPlanet'|trans }}"></span>  {% if usePlanet.getShipOn() > 0 %}<a class="btn btn-lg btn-info float-right mb-2{% if app.user.getTutorial() == 10 %} tutorial-show{% endif %}" href="{{ path('create_fleet', {'idp': usePlanet.getId()}) }}" data-toggle="modal" data-target="#createModal"><span>{{ 'fleet.createFlotte'|trans }}</span></a>{% endif %}</h2></div>
            <table class="table table-striped table-bordered table-dark">
                <tbody>
                <tr>
                    <th class="tab-cells-name text-center">
                        {{ 'fleet.fleetName'|trans }}
                    </th>
                    <th class="tab-cells-name text-center">
                        {{ 'fleet.fleetShips'|trans }} <span class="glyphicon glyphicon-question-sign text-orange" data-toggle="tooltip" data-placement="top" title="{{ 'tooltip.signature'|trans }}"></span>
                    </th>
                    <th class="tab-cells-name text-center">
                        {{ 'fleet.cargo'|trans }} <span class="glyphicon glyphicon-question-sign text-orange" data-toggle="tooltip" data-placement="top" title="{{ 'tooltip.cargo'|trans }}"></span>
                    </th>
                </tr>
                {% for fleet in fleetUsePlanet %}
                    <tr>
                        <th class="tab-cells-name">
                            <span class="ml-3">"{{  fleet.getName() }}"</span>{% if fleet.getFightAt() == null %} {% if fleet.getRecycleur() and fleet.getRecycleAt() %}<span data-toggle="tooltip" data-placement="top" title="{{ 'tooltip.recycle'|trans }}" class="timerArea ml-3 float-right" hidden>{{ fleet.getRecycleAt()|date('Y/m/d H:i:s') }}</span> {% endif %}<span><a class="ml-3 float-right" href="{{ path('destroy_fleet', {'idp': usePlanet.getId(), 'id': fleet.getId()}) }}" data-toggle="tooltip" data-placement="top" title="{{ 'tooltip.drop'|trans }}"><span>{{ 'fleet.destroyFleet'|trans }}</span></a></span> <span><a class="ml-3 float-right" href="{{ path('manage_fleet', {'idp': usePlanet.getId(), 'id': fleet.getId()}) }}" data-toggle="modal" data-target="#editModal"><span>{{ 'fleet.seeFlotte'|trans }}</span></a></span>{% else %}<span class="float-right text-rouge">{{ 'fleet.combat'|trans }}</span>{% endif %}
                        </th>
                        <td class="center-cells text-center">
                            <span class="tipProduct" data-placement="right" data-trigger="" title="{% for ships in fleet.getShipsFleet() %}<div class='my-3 text-left'>{% set x = 0 %}{% for info in ships %} {% if x == 0 %}{{ info }}{% else %}{{ info|trans }}{% endif %}{% set x = x + 1 %} {% endfor %}</div>{% endfor %}" data-html="true">{{ fleet.getNbrShips()|number_format }} => {{ fleet.getNbrSignatures()|number_format }}</span>
                        </td>
                        <td class="center-cells text-center">
                            <span class="tipProduct" data-placement="right" data-trigger="" title="{% for cargos in fleet.getCargosFleet() %}<div class='my-3 text-left'>{% set x = 0 %}{% for info in cargos %} {% if x == 0 %}{{ info }}{% else %}{{ info|trans }}{% endif %}{% set x = x + 1 %} {% endfor %}</div>{% endfor %}" data-html="true">{{ fleet.getCargoFull()|number_format }} / {{ fleet.getCargoPlace()|number_format }}</span>
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
            <div class="block-title mt-5"><h2>{{ 'fleet.inAir'|trans }} <span class="glyphicon glyphicon-question-sign text-orange text-middle" data-toggle="tooltip" data-placement="top" title="{{ 'tooltip.fleetMove'|trans }}"></span></h2></div>
            <table class="table table-striped table-bordered table-dark">
                <tbody>
                <tr>
                    <th class="tab-cells-name text-center">
                        {{ 'fleet.fleetName'|trans }}
                    </th>
                    <th class="tab-cells-name text-center">
                        {{ 'fleet.from'|trans }}
                    </th>
                    <th class="tab-cells-name text-center">
                        {{ 'fleet.goTo'|trans }}
                    </th>
                    <th class="tab-cells-name text-center">
                        {{ 'fleet.time'|trans }}
                    </th>
                    <th class="tab-cells-name text-center">
                        {{ 'fleet.fleetShips'|trans }} <span class="glyphicon glyphicon-question-sign text-orange" data-toggle="tooltip" data-placement="top" title="{{ 'tooltip.signature'|trans }}"></span>
                    </th>
                    <th class="tab-cells-name text-center">
                        {{ 'fleet.cargo'|trans }}
                    </th>
                    <th class="tab-cells-name text-center">
                        {{ 'fleet.cancelFleet'|trans }}
                    </th>
                </tr>
                {% for fleet in fleetMove %}
                    <tr>
                        <th class="tab-cells-name">
                            "{{  fleet.getName() }}"
                        </th>
                        <td class="center-cells text-center">
                            {% if fleet.getPlanet() %}
                                <span><a href="{{ path('map', {'id': fleet.getPlanet().getSector.getPosition(), 'idp': usePlanet.getId(), 'gal': fleet.getPlanet().getSector().getGalaxy().getPosition()}) }}">{{ fleet.getplanet().getName() }} - {{ fleet.getPlanet().getSector().getGalaxy.getPosition() }}:{{ fleet.getPlanet().getSector.getPosition() }}:{{ fleet.getPlanet().getPosition() }}</a></span>
                            {% endif %}
                        </td>
                        <td class="center-cells text-center">
                            <span><a href="{{ path('map', {'id': fleet.getSector().getPosition(), 'idp': usePlanet.getId(), 'gal': fleet.getSector().getGalaxy().getPosition()}) }}">{{ fleet.getSector().getGalaxy.getPosition() }}:{{ fleet.getSector.getPosition() }}:{{ fleet.getPlanete() }}</a></span>
                        </td>
                        <td class="center-cells text-center">
                            <span class="timerArea" hidden>{{ fleet.getFlightTime()|date('Y/m/d H:i:s') }}</span>
                        </td>
                        <td class="center-cells text-center">
                            <span class="tipProduct" data-placement="right" data-trigger="" title="{% for ships in fleet.getShipsFleet() %}<div class='my-3 text-left'>{% set x = 0 %}{% for info in ships %} {% if x == 0 %}{{ info }}{% else %}{{ info|trans }}{% endif %}{% set x = x + 1 %} {% endfor %}</div>{% endfor %}" data-html="true">{{ fleet.getNbrShips()|number_format }} => {{ fleet.getNbrSignatures()|number_format }}</span>
                        </td>
                        <td class="center-cells text-center">
                            <span class="tipProduct" data-placement="right" data-trigger="" title="{% for cargos in fleet.getCargosFleet() %}<div class='my-3 text-left'>{% set x = 0 %}{% for info in cargos %} {% if x == 0 %}{{ info }}{% else %}{{ info|trans }}{% endif %}{% set x = x + 1 %} {% endfor %}</div>{% endfor %}" data-html="true">{{ fleet.getCargoFull()|number_format }} / {{ fleet.getCargoPlace()|number_format }}</span>
                        </td>
                        {% if fleet.cancelFlight() > date %}
                            <td class="center-cells text-center">
                                <a class="text-rouge" href="{{ path('cancel_fleet', {'idp': usePlanet.getId(),'id': fleet.getId()}) }}" data-toggle="tooltip" data-placement="top" title="{{ 'tooltip.cancel'|trans }}"><span class="timerArea" hidden>{{ fleet.cancelFlight()|date('Y/m/d H:i:s') }}</span></a>
                            </td>
                        {% else %}
                            <td class="center-cells text-center">
                            </td>
                        {% endif %}
                    </tr>
                {% endfor %}
                </tbody>
            </table>
            <div class="block-title mt-5"><h2>{{ 'fleet.otherPlanet'|trans }} <span class="glyphicon glyphicon-question-sign text-orange text-middle" data-toggle="tooltip" data-placement="top" title="{{ 'tooltip.fleetOtherPlanet'|trans }}"></span></h2></div>
            <table class="table table-striped table-bordered table-dark">
                <tbody>
                <tr>
                    <th class="tab-cells-name text-center">
                        {{ 'fleet.fleetName'|trans }}
                    </th>
                    <th class="tab-cells-name text-center">
                        {{ 'fleet.planet'|trans }}
                    </th>
                    <th class="tab-cells-name text-center">
                        {{ 'fleet.fleetShips'|trans }} <span class="glyphicon glyphicon-question-sign text-orange" data-toggle="tooltip" data-placement="top" title="{{ 'tooltip.signature'|trans }}"></span>
                    </th>
                    <th class="tab-cells-name text-center">
                        {{ 'fleet.cargo'|trans }}
                    </th>
                </tr>
                {% for fleet in fleetPlanets %}
                    <tr>
                        <th class="tab-cells-name">
                            "{{  fleet.getName() }}"{% if fleet.getFightAt() == null %} {% if fleet.getRecycleur() and fleet.getRecycleAt() %}<span data-toggle="tooltip" data-placement="top" title="{{ 'tooltip.recycle'|trans }}" class="timerArea ml-3 float-right" hidden>{{ fleet.getRecycleAt()|date('Y/m/d H:i:s') }}</span>{% endif %} <span><a class="ml-3 float-right" href="{{ path('destroy_fleet', {'idp': usePlanet.getId(), 'id': fleet.getId()}) }}" data-toggle="tooltip" data-placement="top" title="{{ 'tooltip.drop'|trans }}"><span>{{ 'fleet.destroyFleet'|trans }}</span></a></span> <span><a class="ml-3 float-right" href="{{ path('manage_fleet', {'idp': usePlanet.getId(), 'id': fleet.getId()}) }}" data-toggle="modal" data-target="#editModal"><span>{{ 'fleet.seeFlotte'|trans }}</span></a></span>{% else %}<span class="float-right text-rouge">{{ 'fleet.combat'|trans }}</span>{% endif %}
                        </th>
                        <td class="center-cells text-center">
                            <span><a href="{{ path('map', {id: fleet.getPlanet().getSector.getPosition(), 'idp': usePlanet.getId(), 'gal': fleet.getPlanet().getSector().getGalaxy().getPosition()}) }}">{{ fleet.getplanet().getName() }} - {{ fleet.getPlanet().getSector().getGalaxy.getPosition() }}:{{ fleet.getPlanet().getSector.getPosition() }}:{{ fleet.getPlanet().getPosition() }}</a></span>
                        </td>
                        <td class="center-cells text-center">
                            <span class="tipProduct" data-placement="right" data-trigger="" title="{% for ships in fleet.getShipsFleet() %}<div class='my-3 text-left'>{% set x = 0 %}{% for info in ships %} {% if x == 0 %}{{ info }}{% else %}{{ info|trans }}{% endif %}{% set x = x + 1 %} {% endfor %}</div>{% endfor %}" data-html="true">{{ fleet.getNbrShips()|number_format }} => {{ fleet.getNbrSignatures()|number_format }}</span>
                        </td>
                        <td class="center-cells text-center">
                            <span class="tipProduct" data-placement="right" data-trigger="" title="{% for cargos in fleet.getCargosFleet() %}<div class='my-3 text-left'>{% set x = 0 %}{% for info in cargos %} {% if x == 0 %}{{ info }}{% else %}{{ info|trans }}{% endif %}{% set x = x + 1 %} {% endfor %}</div>{% endfor %}" data-html="true">{{ fleet.getCargoFull()|number_format }} / {{ fleet.getCargoPlace()|number_format }}</span>
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
            <div class="block-title mt-5"><h2>{{ 'fleet.exploration'|trans }} <span class="glyphicon glyphicon-question-sign text-orange text-middle" data-toggle="tooltip" data-placement="top" title="{{ 'tooltip.fleetNoMyPlanet'|trans }}"></span></h2></div>
            <table class="table table-striped table-bordered table-dark">
                <tbody>
                <tr>
                    <th class="tab-cells-name text-center">
                        {{ 'fleet.fleetName'|trans }}
                    </th>
                    <th class="tab-cells-name text-center">
                        {{ 'fleet.planet'|trans }}
                    </th>
                    <th class="tab-cells-name text-center">
                        {{ 'fleet.fleetShips'|trans }} <span class="glyphicon glyphicon-question-sign text-orange" data-toggle="tooltip" data-placement="top" title="{{ 'tooltip.signature'|trans }}"></span>
                    </th>
                    <th class="tab-cells-name text-center">
                        {{ 'fleet.cargo'|trans }}
                    </th>
                </tr>
                {% for fleet in fleetOther %}
                    <tr>
                        <th class="tab-cells-name">
                            "{{  fleet.getName() }}"{% if fleet.getFightAt() == null %} {% if fleet.getRecycleur() and fleet.getRecycleAt() %}<span data-toggle="tooltip" data-placement="top" title="{{ 'tooltip.recycle'|trans }}" class="timerArea ml-3 float-right" hidden>{{ fleet.getRecycleAt()|date('Y/m/d H:i:s') }}</span>{% endif %}{% if fleet.getBarge() and fleet.getPlanet().getUser() and fleet.getAllianceUser() and fleet.getSoldier() %}<span><a data-toggle="tooltip" data-placement="top" title="{{ 'tooltip.invade'|trans }}" class="badge badge-danger ml-3 float-right" href="{{ path('invader_planet', {'idp': usePlanet.getId(), 'fleet': fleet.getId()}) }}"><span class="text-middle">{{ 'fleet.invade'|trans }}</span></a></span>{% elseif fleet.getColonizer() and fleet.getPlanet().getUser() == null and fleet.getPlanet().getEmpty() == false and fleet.getPlanet().getMerchant() == false and fleet.getPlanet().getCdr() == false and app.user.getColPlanets()|length < 20 and app.user.getColPlanets() <= (app.user.getTerraformation() + 1 + app.user.getPoliticColonisation()) %}<span><a data-toggle="tooltip" data-placement="top" title="{{ 'tooltip.colonize'|trans }}" class="badge badge-success ml-3 float-right" href="{{ path('colonizer_planet', {'fleet': fleet.getId()}) }}"><span class="text-middle">{{ 'fleet.colonize'|trans }}</span></a></span>{% endif %} <span><a class="ml-3 float-right" href="{{ path('manage_fleet', {'idp': usePlanet.getId(), 'id': fleet.getId()}) }}" data-toggle="modal" data-target="#editModal"><span>{{ 'fleet.seeFlotte'|trans }}</span></a></span>{% else %}<span class="float-right text-rouge">{{ 'fleet.combat'|trans }}</span>{% endif %}
                        </th>
                        <td class="center-cells text-center">
                            <span><a href="{{ path('map', {id: fleet.getPlanet().getSector.getPosition(), 'idp': usePlanet.getId(), 'gal': fleet.getPlanet().getSector().getGalaxy().getPosition()}) }}">{{ fleet.getplanet().getName() }} - {{ fleet.getPlanet().getSector().getGalaxy.getPosition() }}:{{ fleet.getPlanet().getSector.getPosition() }}:{{ fleet.getPlanet().getPosition() }}</a></span>
                        </td>
                        <td class="center-cells text-center">
                            <span class="tipProduct" data-placement="right" data-trigger="" title="{% for ships in fleet.getShipsFleet() %}<div class='my-3 text-left'>{% set x = 0 %}{% for info in ships %} {% if x == 0 %}{{ info }}{% else %}{{ info|trans }}{% endif %}{% set x = x + 1 %} {% endfor %}</div>{% endfor %}" data-html="true">{{ fleet.getNbrShips()|number_format }} => {{ fleet.getNbrSignatures()|number_format }}</span>
                        </td>
                        <td class="center-cells text-center">
                            <span class="tipProduct" data-placement="right" data-trigger="" title="{% for cargos in fleet.getCargosFleet() %}<div class='my-3 text-left'>{% set x = 0 %}{% for info in cargos %} {% if x == 0 %}{{ info }}{% else %}{{ info|trans }}{% endif %}{% set x = x + 1 %} {% endfor %}</div>{% endfor %}" data-html="true">{{ fleet.getCargoFull()|number_format }} / {{ fleet.getCargoPlace()|number_format }}</span>
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
        <div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-labelledby="editModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
                <div class="modal-content special">
                </div>
            </div>
        </div>
        <div class="modal fade" id="createModal" tabindex="-1" role="dialog" aria-labelledby="createModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content special">
                </div>
            </div>
        </div>
    </div>
{% endblock %}
