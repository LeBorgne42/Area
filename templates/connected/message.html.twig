{% extends 'base.html.twig' %}

{% trans_default_domain 'front_message' %}

{% block title %}{{ 'title'|trans }}{% endblock %}

{% block body %}
    <div class="front-block display-message">
        <ul class="nav nav-tabs mt-1" id="myTab" role="tablist">
            <li class="nav-item">
                <a class="nav-link active" id="received-tab" data-toggle="tab" href="#received" role="tab" aria-controls="received" aria-selected="true"><h2>{{ 'message.received'|trans }}</h2></a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="create-tab" data-toggle="tab" href="#create" role="tab" aria-controls="create" aria-selected="true"><h2>{{ 'message.create'|trans }}</h2></a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="sent-tab" data-toggle="tab" href="#sent" role="tab" aria-controls="sent" aria-selected="true"><h2>{{ 'message.sent'|trans }}</h2></a>
            </li>
        </ul>
        <div class="tab-content" id="myTabContent">
            <div class="tab-pane fade show active" id="received" role="tabpanel" aria-labelledby="received-tab">
                {% for message in messagesR %}
                    <table class="table table-striped table-bordered table-dark">
                        <tbody>
                        <tr>
                            <th class="tab-cells-name">
                                <span class="ml-3">
                                    {{ 'message.sender'|trans }}
                                    {% if message.getSender() %}<a href="{{ path('user_profil', {'idp': usePlanet.getId(), 'id': message.getIdSender()}) }}">{{ message.getSender() }}</a>{% else %}{{ 'message.anonymousSender'|trans }}{% endif %}
                                </span>
                                <span class="float-right">
                                    {{ 'message.bitcoinRe'|trans }}
                                    {{ message.getBitcoin() }}
                                </span>
                            </th>
                            <th class="tab-cells-name">
                                <span class="ml-3">
                                    {{ 'message.title'|trans }}
                                    {{ message.getTitle() }}
                                </span>
                                <span class="float-right">
                                    {{ message.getSendAt()|date('Y/m/d H:i:s') }}
                                </span>
                            </th>
                        </tr>
                        <tr>
                            <th colspan="2" class="tab-cells-name">
                                <div class="p-3">
                                    {{ message.getContent()|raw }}
                                </div>
                            </th>
                        </tr>
                        </tbody>
                    </table>
                {% endfor %}
            </div>
            <div class="tab-pane" id="create" role="tabpanel" aria-labelledby="create-tab">
                {{ form_start(form_message) }}
                <table class="table table-striped table-bordered table-dark">
                    <tbody>
                    <tr>
                        <th class="tab-cells-name text-center">
                            <div class="row">
                                <div class="offset-2 col-8">
                                    {{ form_widget(form_message.user) }}
                                </div>
                            </div>
                        </th>
                        <th class="tab-cells-name text-center">
                            <div class="row">
                                <div class="offset-2 col-8">
                            {{ form_widget(form_message.title) }}
                                </div>
                            </div>
                        </th>
                    </tr>
                    <tr>
                        <th colspan="2" class="tab-cells-name">
                            <div class="p-3">
                                {{ form_widget(form_message.content) }}
                            </div>
                            <div class="row mt-3 ml-3">
                                <div class="form-text">
                                    {{ 'message.anonymous'|trans }}
                                </div>
                                <div class="col-1">
                                    {{ form_widget(form_message.anonymous) }}
                                </div>
                                <div class="offset-3 col-2 form-text">
                                    {{ 'message.bitcoin'|trans }}
                                </div>
                                <div class="col-2">
                                    {{ form_widget(form_message.bitcoin,{attr: { max: app.user.getBitcoin()}}) }}
                                </div>
                            </div>
                        </th>
                    </tr>
                    </tbody>
                </table>
                {{ form_widget(form_message.sendForm,{attr: { class: 'btn btn-lg btn-info float-right mt-3'}}) }}
                {{ form_end(form_message) }}
            </div>
            <div class="tab-pane" id="sent" role="tabpanel" aria-labelledby="sent-tab">
                {% for message in messages %}
                    <table class="table table-striped table-bordered table-dark">
                        <tbody>
                        <tr>
                            <th class="tab-cells-name">
                                <span class="ml-3">
                                    {{ 'message.sendTo'|trans }}
                                    <a href="{{ path('user_profil', {'idp': usePlanet.getId(), 'id': message.getUser().getId()}) }}">{{ message.getUser().getUserName() }}</a>
                                    {% if message.getSender is null %}<span class="text-vert ml-3">{{ 'message.sendAnonym'|trans }}</span>{% endif %}
                                </span>
                                <span class="float-right">
                                    {{ 'message.bitcoinRe'|trans }}
                                    {{ message.getBitcoin() }}
                                </span>
                            </th>
                            <th class="tab-cells-name">
                                <span class="ml-3">
                                    {{ 'message.title'|trans }}
                                    {{ message.getTitle() }}
                                </span>
                                <span class="float-right">
                                    {{ message.getSendAt()|date('Y/m/d H:i:s') }}
                                </span>
                            </th>
                        </tr>
                        <tr>
                            <th colspan="2" class="tab-cells-name">
                                <div class="p-3">
                                    {{ message.getContent()|raw }}
                                </div>
                            </th>
                        </tr>
                        </tbody>
                    </table>
                {% endfor %}
            </div>
        </div>
    </div>
{% endblock %}
