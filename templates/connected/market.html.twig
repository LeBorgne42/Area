{% extends 'base.html.twig' %}

{% trans_default_domain 'front_market' %}

{% block title %}{{ 'title'|trans }}{% endblock %}

{% block body %}
    <div class="front-block">
        {% if app.user.getTutorial() == 17 %}
            <table class="table table-striped borderOverview tutorial">
                <tbody>
                <tr>
                    <th class="tab-cells-name p-3 tutorial">
                        <div class="row">
                            <div class="col-12 py-1">
                                {% if app.user.getTutorial() == 17  %}{{ 'quest.tutorial'|trans|raw }}{% endif %}
                            </div>
                        </div>
                    </th>
                </tr>
                </tbody>
            </table>
        {% endif %}
        <div class="front-block-ally">
            {% if quests %}
                <div class="mb-4">
                    {{ 'quest.info'|trans }}
                </div>
                <table class="table table-striped table-bordered table-dark mb-5">
                    <tbody>
                    <tr>
                        <th class="tab-cells-name text-center">
                            {{ 'quest.name'|trans }}
                        </th>
                        <th class="tab-cells-name text-center">
                            {{ 'quest.gain'|trans }}
                        </th>
                        <th class="tab-cells-name text-center">
                            {{ 'quest.star'|trans }}
                        </th>
                    </tr>
                    {% for quest in quests %}
                            <tr class="text-center">
                                <td>{{ quest.name|trans|raw }}</td>
                                <td>{{ quest.gain|number_format }} <img src="{{ asset('img/pdg.png') }}"</td>
                                <td>
                                    {% if quest.gain == 2500 %}
                                        <div class="text-or glyphicon glyphicon-star"></div>
                                    {% elseif quest.gain == 5000 %}
                                        <div class="text-or glyphicon glyphicon-star"></div>
                                        <div class="text-or glyphicon glyphicon-star"></div>
                                    {% elseif quest.gain == 10000 %}
                                        <div class="text-or glyphicon glyphicon-star"></div>
                                        <div class="text-or glyphicon glyphicon-star"></div>
                                        <div class="text-or glyphicon glyphicon-star"></div>
                                    {% elseif quest.gain == 20000 %}
                                        <div class="text-or glyphicon glyphicon-star"></div>
                                        <div class="text-or glyphicon glyphicon-star"></div>
                                        <div class="text-or glyphicon glyphicon-star"></div>
                                        <div class="text-or glyphicon glyphicon-star"></div>
                                    {% elseif quest.gain == 40000 %}
                                        <div class="text-or glyphicon glyphicon-star"></div>
                                        <div class="text-or glyphicon glyphicon-star"></div>
                                        <div class="text-or glyphicon glyphicon-star"></div>
                                        <div class="text-or glyphicon glyphicon-star"></div>
                                        <div class="text-or glyphicon glyphicon-star"></div>
                                    {% endif %}
                                </td>
                            </tr>
                    {% endfor %}
                    </tbody>
                </table>
            {% endif %}
            {{ form_start(form_market) }}
            <img class="float-left" src="{{ asset('img/market.jpg') }}">
            <div class="row">
                <div class="col-12 mb-5">
                    {{ 'market.text'|trans }}
                </div>
                <div class="col-3 mb-3">
                    {{ 'market.planet'|trans }}
                </div>
                <div class="col-3 mb-3">
                    {{ form_widget(form_market.planet) }}
                </div>
                <div class="col-4 mb-3">
                    {{ 'market.bitcoin'|trans|raw }}
                </div>
                <div class="col-2 mb-3">
                    {{ form_widget(form_market.bitcoin,{attr: { max: app.user.getRank().getWarPoint() }}) }}
                </div>
                <div class="col-4">
                    {{ 'market.worker'|trans|raw }}
                </div>
                <div class="col-2">
                    {{ form_widget(form_market.worker,{attr: { max: app.user.getRank().getWarPoint() }}) }}
                </div>
                <div class="col-4">
                    {{ 'market.soldier'|trans|raw }}
                </div>
                <div class="col-2">
                    {{ form_widget(form_market.soldier,{attr: { max: app.user.getRank().getWarPoint() }}) }}
                </div>
                <div class="col-12 mt-5">
                    {{ form_widget(form_market.sendForm) }}
                </div>
                <div class="col-12 mt-5">
                    {{ 'market.pdg'|trans }} {{ app.user.getRank().getWarPoint()|number_format }} <img src="{{ asset('img/pdg.png') }}"> {{ 'market.pdgs'|trans }}
                </div>
            </div>
            {{ form_end(form_market) }}
        </div>
        <div class="front-block-ally mt-4 mb-5">
            <form class="planetList_add mb-2" name="planetList_add" method="post" action="{{ path('planet_seller_add', {'idp': usePlanet.getId(), 'planet': '0'}) }}">
                <span data-toggle="tooltip" data-placement="top" title="{{ 'tooltip.autoSell'|trans }}" class="mr-5 text-more">{{ 'market.autoSell'|trans|raw }}<span class="glyphicon glyphicon-question-sign text-orange"></span></span>
                <select class="planetChoice select2">
                    <option value="">{{ 'planetList.add'|trans }}</option>
                    {% for planet in planetsNoSell %}
                        {% if planet.getOffensiveFleet(app.user) != 'ennemy' %}
                            <option value="{{ planet.getId() }}">{{ planet.getName() }}</option>
                        {% endif %}
                    {% endfor %}
                </select>
                <button type="submit" id="planet_choice_send" hidden></button>
            </form>
            <table class="table table-striped table-bordered table-dark seller-table">
                <tbody>
                    <tr>
                    {% set x = 0 %}
                    {% for planet in planetsSeller %}
                        {% if x % 5 == 0 %}
                            <tr>
                        {% endif %}
                            <td width="160" class="center-cells text-center">
                                <a class="text-rouge" href="{{ path('planet_seller_sub', {'idp': usePlanet.getId(), 'planet': planet.getId()}) }}" data-toggle="tooltip" data-placement="top" title="{{ 'tooltip.remove'|trans }}">X</a> {{ planet.getName() }}
                            </td>
                        {% set x = x + 1 %}
                        {% if x % 5 == 0 %}
                            </tr>
                        {% endif %}
                    {% endfor %}
                    </tr>
                </tbody>
            </table>
            <div class="row mt-5">
                <div class="offset-6 col-6">
                    <a class="confirm-button" href="{{ path('planets_seller', {'idp': usePlanet.getId()}) }}">{{ 'market.sellAll'|trans }}</a>
                </div>
        </div>
    </div>
{% endblock %}
