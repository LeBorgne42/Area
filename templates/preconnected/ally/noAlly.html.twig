{% extends 'base.html.twig' %}

{% trans_default_domain 'front_ally' %}

{% block title %}{{ 'title'|trans }}{% endblock %}

{% block body %}
    {%- block left_menu -%}
    {%- endblock -%}
    {%- block top_ressource -%}
    {%- endblock -%}
    {%- block right_planet -%}
    {%- endblock -%}
    <div class="front-block-ally">
        {% if app.user.getAlly() %}
        {% else %}
            {% if app.user.getAllyBan() %}<h3 class="text-center text-rouge mb-5">{{ 'ally.banAlly'|trans }} <span class="timerArea" hidden>{{ app.user.getAllyBan()|date('Y/m/d H:i:s') }}</span></h3>{% endif %}
            {{ form_start(form_ally) }}
            <div class="row">
                <div class="offset-1 col-4 form-group">
                    {{ form_widget(form_ally.name) }}
                </div>
                <div class="col-2 form-group">
                    {{ form_widget(form_ally.sigle) }}
                </div>
                <div class="col-2 form-control-plaintext">
                    {{ form_label(form_ally.taxe) }}
                </div>
                <div class="col-2 form-group">
                    {{ form_widget(form_ally.taxe) }}
                </div>
            </div>
            <div class="row">
                <div class="offset-1 col-7 form-group">
                    {{ form_widget(form_ally.slogan) }}
                </div>
                <div class="col-3 form-group">
                    {{ form_widget(form_ally.politic) }}
                </div>
                <div class="offset-1 col-10 form-group">
                    {{ form_widget(form_ally.description) }}
                    <div><span class="pull-left mt-3">{{ form_widget(form_ally.politic) }}</span><span class="pull-right mt-3">{{ form_widget(form_ally.sendForm,{attr: { class: 'btn btn-lg btn-info'}}) }}</span></div>
                </div>
            </div>
            {{ form_end(form_ally) }}

            <h3 class="text-center text-orange mt-5">{{ 'ally.proposals'|trans }}</h3>
            <table class="table table-striped table-bordered table-dark text-center mt-3">
                <tbody>
                <tr>
                    <th class="tab-cells-name">{{ 'ally.allyName'|trans }}</th>
                    <th class="tab-cells-name">{{ 'ally.proposalAt'|trans }}</th>
                    <th class="tab-cells-name">{{ 'ally.acceptProp'|trans }}</th>
                    <th class="tab-cells-name">{{ 'ally.refuseProp'|trans }}</th>
                </tr>
                {% for proposal in app.user.getProposals() %}
                    <tr>
                        <td class="center-cells">
                            <span><a href="{{ path('pre_ally_profil', {'id': proposal.getAlly().getId()}) }}">{{ proposal.getAlly().getName() }}</a></span>
                        </td>
                        <td class="center-cells">
                            {{ proposal.getProposalAt()|date('d/m/Y H:i') }}
                        </td>
                        <td class="center-cells">
                            <a href="{{ path('pre_ally_accept', {id: proposal.getId()}) }}"><span>{{ 'ally.accept'|trans }}</span></a>
                        </td>
                        <td class="center-cells">
                            <a class="text-rouge" href="{{ path('pre_ally_refuse', {id: proposal.getId()}) }}"><div class="glyphicon glyphicon-remove"></div> <span>{{ 'ally.refuse'|trans }}</span></a>
                        </td>
                    </tr>
                {% endfor %}
                </tr>
                </tbody>
            </table>
        {% endif %}
        <div class="pre-rank">
            <h3 class="text-center text-orange mb-3">{{ 'ally.ranked'|trans }}</h3>
            <table class="table table-striped table-bordered table-dark text-center">
                <tbody>
                <tr>
                    <th class="tab-cells-name p-2">
                        {{ 'rank.ally'|trans }}
                    </th>
                    <th class="tab-cells-name p-2">
                        {{ 'rank.members'|trans }}
                    </th>
                    <th class="tab-cells-name p-2">
                        {{ 'rank.createdAt'|trans }}
                    </th>
                </tr>
                {% set x = 1 %}
                {% for ally in allAllys %}
                    <tr>
                        <th class="tab-cells-name p-2">
                            <span><a data-toggle="modal" data-target="#userModal" href="{{ path('pre_ally_profil_modal', {'id': ally.getId()}) }}">[{{ ally.getSigle() }}] {{ ally.getName() }}</a></span>
                        </th>
                        <th class="tab-cells-name p-2">
                            {{ ally.getUsers()|length }} / 6
                        </th>
                        <th class="tab-cells-name p-2">
                            {{ ally.getcreatedAt()|date('H:i:s d/m/Y') }}
                        </th>
                    </tr>
                    {% set x = x + 1 %}
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    <div class="modal fade" id="userModal" tabindex="-1" role="dialog" aria-labelledby="userModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content special">
            </div>
        </div>
    </div>
{% endblock %}
